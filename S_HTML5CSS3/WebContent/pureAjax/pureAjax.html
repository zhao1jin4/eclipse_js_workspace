<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
<!-- 
<%
String project = request.getContextPath();
%>
 -->

<script type="text/javascript">

var  root="/S_HTML5CSS3"; 
function createXmlHttp()
{
	if (window.XMLHttpRequest)
	{
	  xmlHttp=new XMLHttpRequest();// code for IE7, Firefox, Opera, etc.
	}
	else if (window.ActiveXObject)
	{
	  xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");// code for IE6, IE5
	}
	if (xmlHttp==null)
	{
		  alert("Your browser does not support XMLHTTP.");
	}
	return xmlHttp;
}
function getXML()
{
	//<root><status>OK</status><description>%E4%B8%AD%E6%96%87</description></root>

	var xmlHttp=createXmlHttp();
	xmlHttp.onreadystatechange=function()
	{
			if(xmlHttp.readyState!=4) return;
			if(xmlHttp.status!=200)
			{
				alert("Problem retrieving XML data");//js和服务不在一项目中,firefox有错,IE 是OK
			 	return;
			}
		/*
			//---firefox OK， <?xml　和　response.setContentType("text/xml;charset=UTF-8");　　都可有可无
			var doc=xmlHttp.responseXML.documentElement;//IE 一定不能有<?xml，也 OK
			var status=doc.getElementsByTagName("status");
			alert(status[0].textContent);//firefox是textContent
		*/
		
				
				
			//----IE 测试OK  一定不能有<?xml . 要服务端一定要有　response.setContentType("text/xml;charset=UTF-8");
						
			var objXml=xmlHttp.responseXML;
			//objXml.childNodes[0].firstChild.textContent;//firefox 是的结果是OK
			//objXml.getElementsByTagName("status")[0].textContent;//firefox 是的结果是OK
			//objXml.childNodes[0].firstChild.text;//IE的结果是OK
			//objXml.getElementsByTagName("status")[0].text;//IE的结果是OK
			
			var xmlDoc;
			if (window.ActiveXObject)
			  xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
			else if (document.implementation.createDocument)
			  xmlDoc=document.implementation.createDocument("","",null);
			else
			  alert('Your browser cannot handle this script');
			xmlDoc.async=false;
			xmlDoc.load(objXml); //xmlDoc有一个parseError.reason属性
			alert(xmlDoc.getElementsByTagName("status")[0]);
			var status=xmlDoc.getElementsByTagName("status")[0].text;//IE 是text属性
			if(status=="OK")
			{
				var des=xmlDoc.getElementsByTagName("description")[0].text;
				var decode=decodeURI(des);
				document.getElementById("result").innerHTML=decode;
			}

	};	
	
	/*
	//firefox true is OK,false not work
	//IE true,false OK,
	xmlHttp.open("GET", "xmlServlet?username="+encodeURI(encodeURI('李')), true);//是否异步,true 异步,false同步
	xmlHttp.send(null);//GET 用null  发送
	*/
	
	xmlHttp.open("POST", root+"/xmlServlet", true);//是否异步,true 异步,false同步
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")//open方法后 调用 ;
	xmlHttp.send("username="+encodeURI(encodeURI('李')));
}




</script>
<input type="button" id="mybtn" value="getXML(IE)" onclick="getXML();"/>
<div id="result"></div>
</body>
</html>