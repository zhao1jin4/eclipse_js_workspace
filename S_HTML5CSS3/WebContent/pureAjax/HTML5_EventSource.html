<!DOCTYPE html>
<html > 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
<style type="text/css">
	 
</style>


</head>
<body>
	w3school 网上的教程
	 
	<hr/>
	服务器推消息  
	<div id="server_send_result"></div>
<script>
//EventSource非标准
//https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events

	if(typeof(EventSource)!=="undefined")
	{
		var source=new EventSource("html5_server-send-event.jsp");
		//server要 response.addHeader("Content-Type", "text/event-stream");
		//response.addHeader("Cache-Control", "no-cache");
		//消息要以data:开头
		 
		source.onmessage=function(event)
		  {
		  	document.getElementById("server_send_result").innerHTML+=event.data + "<br />";
		  };
		   
		  
		 	  /*
		  source.addEventListener("ping", function(e) {
			  var newElement = document.createElement("li");
			  
			  var obj = JSON.parse(e.data);
			  newElement.innerHTML = "ping at " + obj.time;
			  eventList.appendChild(newElement);
			}, false);	
		 */
	}
	else
	{
		document.getElementById("server_send_result").innerHTML="Sorry, your browser does not support server-sent events...";
	}
	
</script>
	
</body>
</html>